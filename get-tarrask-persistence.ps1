<#
Source: Tarrask malware uses scheduled tasks for defense evasion
URL: https://www.microsoft.com/security/blog/2022/04/12/tarrask-malware-uses-scheduled-tasks-for-defense-evasion/
--
This scripts checks for Scheduled Task that have been modified by deleting their SD entry in the registry.
Deleting this entry makes the task "disappear" from the Scheduled Tasks in a effort to evade its detection.
#>

$tasks=Get-ChildItem -Path 'HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\' -Recurse

foreach ($task in $tasks.Name) {

    $check = Get-Item -Path Registry::$task
    
    if ($check.Property.Contains('SD') -eq $False) {
        Get-Item -Path Registry::$check
    }
    
} 
