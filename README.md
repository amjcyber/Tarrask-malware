# Tarrask-malware

Source: [Microsoft - Tarrask malware uses scheduled tasks for defense evasion](https://www.microsoft.com/security/blog/2022/04/12/tarrask-malware-uses-scheduled-tasks-for-defense-evasion/)

### How to
Just run `.\get-tarrask-persistence.ps1` and you will get the results

### Reproduce behavior
#### Create a new task
![New task](https://i.imgur.com/fSiw8Ng.png)
#### Check that the SD entry exists
![SD entry](https://i.imgur.com/VF6uznd.jpg)
Delete the SD entry (you need to be System!)
#### The Task disappears from Scheduled Tasks
![Task doesn't appear](https://i.imgur.com/lHF8vUC.png)
#### Run the script
![Script run](https://i.imgur.com/9Y0U195.jpg)

### Remove
You can remove entries manually or with Powershell. You will need to have SYSTEM privileges

`Get-Item 'HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\NAME-OF-TASK' | Remove-Item -Force -Verbose`

`Get-Item 'HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks\ID-OF-TASK' | Remove-Item -Force -Verbose`
